name: Audit
on:
  pull_request:
    paths: [Cargo.toml, Cargo.lock]
    types: [synchronize, opened, edited]
  push:
    paths: [Cargo.toml, Cargo.lock]
jobs:
  skip:
    name: Check Duplicate Actions
    # continue-on-error: true
    runs-on: ubuntu-latest
    outputs:
      should-skip: ${{ steps.skip-check.outputs.should_skip }}
    steps:
      - name: Skip Duplicate Actions (Audit)
        uses: fkirc/skip-duplicate-actions@f75dd6564bb646f95277dc8c3b80612e46a4a1ea # renovate: tag=v3
        id: skip-check
  audit:
    name: Audit
    runs-on: ubuntu-latest
    needs: skip
    if: needs.skip.outputs.should-skip != 'true'
    steps:
      - name: Checkout
        uses: actions/checkout@2541b1294d2704b0964813337f33b291d3f8596b # tag=v3
      - name: Audit Check
        uses: actions-rs/audit-check@35b7b53b1e25b55642157ac01b4adceb5b9ebef3 # renovate: tag=v1
        with:
          token: ${{github.token}}
